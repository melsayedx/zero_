# Optimized configuration for high-throughput log ingestion
# Copy these settings to your .env file for maximum performance

# Core optimizations
USE_OBJECT_POOLING=true
USE_REQUEST_COALESCING=true

# High-throughput configuration
OBJECT_POOL_INITIAL_SIZE=2000
OBJECT_POOL_MAX_SIZE=20000
COALESCER_MAX_WAIT_TIME=5      # Faster coalescing (was 10ms)
COALESCER_MAX_BATCH_SIZE=200   # Larger batches (was 100)
BUFFER_POOL_SIZE=200

# Worker optimizations
LOG_PROCESSOR_WORKER_COUNT=4   # Multiple workers (was 1)
WORKER_REDIS_BATCH_SIZE=3000   # Larger Redis batches (was 1000)
WORKER_POLL_INTERVAL=2         # Faster polling (was 10ms)

# ClickHouse optimizations
CLICKHOUSE_BATCH_SIZE=50000    # Much larger batches (was 10000)

# Validation optimizations
ENABLE_WORKER_VALIDATION=true
VALIDATION_SMALL_BATCH_THRESHOLD=100   # Higher threshold
WORKER_POOL_MIN_WORKERS=4
WORKER_POOL_MAX_WORKERS=8

# Existing settings (keep as-is)
HOST=localhost
PORT=3000
NODE_ENV=development

CLICKHOUSE_HOST=http://localhost:8123
CLICKHOUSE_DATABASE=logs_db
CLICKHOUSE_USER=default
CLICKHOUSE_PASSWORD=
CLICKHOUSE_TABLE=logs

# Worker Validation
VALIDATION_MEDIUM_BATCH_THRESHOLD=1000
VALIDATION_LARGE_BATCH_THRESHOLD=5000
FORCE_WORKER_VALIDATION=false
WORKER_TASK_TIMEOUT=15000

# Cluster Configuration
CLUSTER_WORKERS=2
CLUSTER_API_PORT=9000

# Health & Monitoring
HEALTH_CHECK_INTERVAL=30000
WORKER_RESTART_DELAY=5000

# Resource Limits
WORKER_MEMORY_LIMIT=1610612736
